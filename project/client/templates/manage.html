{% extends "base.html" %}

{% block title %}

Manage your fantasy league {{ fantasy.leagueName }}

{% endblock %}



{% block content %}

<style>
    .containerdiv {
        float: left;
        position: relative;
    }

    .cornerimage {
        position: absolute;
        top: 0;
        right: 0;
    }

    .popover {
        max-width: 400px;
    }

    .dragon {
        margin: -5px;
    }
</style>

<h1 align="center">{{ fantasy.leagueName }}</h1>

{% if user.id == fantasy.owner %}





<br />
<h2 align="center">Scoring table</h2>


<table style="border-collapse: collapse; width: 100%;" border="1">
    <tbody>
        <tr>
            <td>

            </td>
            <td>

            </td>
        </tr>
    </tbody>
</table>

<form method="post">
    <table style="border-collapse: collapse; width: 100%; height: 173px;" border="1">
        <tbody>
            <tr style="height: 155px;">
                <td style="width: 25%; height: 155px;">
                    <table style="border-collapse: collapse; width: 100%;" border="1">
                        <tbody>
                            <tr>
                                <td style="width: 50%;">Kills</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="kill_points" name="kill_points"
                                        placeholder="{{ fantasy.kill }}" value="{{ fantasy.kill }}" step="any" />
                                </td>
                            </tr>

                            <tr>
                                <td style="width: 50%;">Deaths</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="death_points" name="death_points"
                                        placeholder="{{ fantasy.death }}" value="{{ fantasy.death }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">Assists</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="assist_points" name="assist_points"
                                        placeholder="{{ fantasy.assist }}" value="{{ fantasy.assist }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">Wards Placed</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="wardPlace_points"
                                        name="wardPlace_points" placeholder="{{ fantasy.wardPlace }}"
                                        value="{{ fantasy.wardPlace }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">Wards Killed</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="wardKill_points"
                                        name="wardKill_points" placeholder="{{ fantasy.wardKill }}"
                                        value="{{ fantasy.wardKill }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">CS</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="cs_points" name="cs_points"
                                        placeholder="{{ fantasy.cs }}" value="{{ fantasy.cs }}" step="any" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td style="width: 25%; height: 155px;">
                    <table style="border-collapse: collapse; width: 100%;" border="1">
                        <tbody>
                            <tr>
                                <td style="width: 50%;">First Baron</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="firstBaron_points"
                                        name="firstBaron_points" placeholder="{{ fantasy.firstBaron }}"
                                        value="{{ fantasy.firstBaron }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">First Dragon</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="firstDragon_points"
                                        name="firstDragon_points" placeholder="{{ fantasy.firstDragon }}"
                                        value="{{ fantasy.firstDragon }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">First Tower</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="firstTower_points"
                                        name="firstTower_points" placeholder="{{ fantasy.firstTower }}"
                                        value="{{ fantasy.firstTower }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">First Blood</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="firstBlood_points"
                                        name="firstBlood_points" placeholder="{{ fantasy.firstBlood }}"
                                        value="{{ fantasy.firstBlood }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">Solo kill</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="soloKill_points"
                                        name="soloKill_points" placeholder="{{ fantasy.soloKill }}"
                                        value="{{ fantasy.soloKill }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">CS@15 role comparison</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="morecs15_points"
                                        name="morecs15_points" placeholder="{{ fantasy.morecs15 }}"
                                        value="{{ fantasy.morecs15 }}" step="any" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td style="width: 25%; height: 155px;">
                    <table style="border-collapse: collapse; width: 100%;" border="1">
                        <tbody>
                            <tr>
                                <td style="width: 50%;">Baron kills</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="baron_points" name="baron_points"
                                        placeholder="{{ fantasy.baron }}" value="{{ fantasy.baron }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">Dragon kills</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="dragon_points" name="dragon_points"
                                        placeholder="{{ fantasy.dragon }}" value="{{ fantasy.dragon }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">Towers destroyed</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="tower_points" name="tower_points"
                                        placeholder="{{ fantasy.tower }}" value="{{ fantasy.tower }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">Soul claimed</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="soul_points" name="soul_points"
                                        placeholder="{{ fantasy.soul }}" value="{{ fantasy.soul }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">Elder kills</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="elder_points" name="elder_points"
                                        placeholder="{{ fantasy.elder }}" value="{{ fantasy.elder }}" step="any" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%;">Win (not working)</td>
                                <td style="width: 20%;">
                                    <input type="number" class="form-control" id="win_points" name="win_points"
                                        placeholder="{{ fantasy.win }}" value="{{ fantasy.win }}" step="any" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </tbody>
    </table>
    <button type="submit" name="action" class="btn btn-primary" value="Settings">Save</button>
</form>
{% if not fantasy.rounds %}
<h2 align="center">Add a player</h2>

<form method="POST">
    <input type="email" class="form-control" id="player_invite" name="player_invite" placeholder="name@email.com" />
    <button type="submit" name="action" class="btn btn-primary" value="Invite">Invite</button>
</form>





<form method="POST">
    <button type="submit" name="action" class="btn btn-primary" value="generate">Generate</button>
</form>
{% endif %}


{% endif %}
{% if fantasy.rounds %}
Testing an alternate display option
<div id="carouselExampleIndicators" class="carousel carousel-dark slide" data-bs-touch="true">
    <div class="carousel-indicators">
        {% for i in range(fantasy.rounds|length) %}

        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to={{i}}
            {% if loop.index == now + 1 %} class="active" aria-current="true" {%else%} aria-current="false" {% endif %}
            aria-label="Slide {{i+1}}"></button>

        {% endfor %}
    </div>
    <div class="carousel-inner px-5">
        {% for round in fantasy.rounds %}
        <div class="carousel-item {% if loop.index == now + 1 %} active {% endif %}">
            <div class="card d-block px-0 px-md-5 pb-5">
                <div class="container px-0 px-md-5">
                    <div class="row">
                        <div class="card-body">
                            <center>
                                <h5 class="card-title">Round {{round.number}}</h5>


                            </center>
                        </div>
                    </div>
                    <div class="accordion" id="{{'round' + round.number|string }}">
                        {% for matchup in round.weekstats %}


                        <div class="accordion-item">
                            <h2 class="accordion-header"
                                id="{{'heading' + round.number|string + '_' + matchup.id|string}}">

                                <button
                                    class="accordion-button {% if not ((matchup.team1 in user.teams|selectattr('id', 'equalto', matchup.team1)|map(attribute = 'id')|list) or (matchup.team2 in user.teams|selectattr('id', 'equalto', matchup.team2)|map(attribute = 'id')|list)) %}collapsed{% endif %} d-block text-center"
                                    type="button" data-bs-toggle="collapse"
                                    data-bs-target="{{'#collapse' + round.number|string + '_' + matchup.id|string}}"
                                    aria-expanded="{% if (matchup.team1 in user.teams|selectattr('id', 'equalto', matchup.team1)|map(attribute = 'id')|list) or (matchup.team2 in user.teams|selectattr('id', 'equalto', matchup.team2)|map(attribute = 'id')|list) %}true{% else %}false{% endif %}"
                                    aria-controls="{{'collapse' + round.number|string + '_' + matchup.id|string}}">
                                    <div class="row">
                                        <div class="col" align="right">
                                            {% for team in fantasy.teams %}
                                            {% if team.id == matchup.team1 %}
                                            {% if matchup.total1 > matchup.total2 and matchup.total1 != 0 %}
                                            <img src="/static/img/crown.png" width="15" height="15" />
                                            {% endif %}
                                            {{ team.name }}
                                            <br />
                                            {% if matchup.total1 %}
                                            <span style="color: #888888">{{'%0.2f'| format(matchup.base1) }}</span>
                                            <span style="color: #000000">{{'%0.2f'| format(matchup.total1) }}</span>
                                            {% else %}
                                            <br />
                                            {% endif %}
                                            {% endif %}
                                            {% endfor %}
                                            </a>
                                        </div>
                                        <div class="col" align="left">
                                            {% for team in fantasy.teams %}
                                            {% if team.id == matchup.team2 %}
                                            {{ team.name }}
                                            {% if matchup.total2 > matchup.total1 and matchup.total2 != 0 %}
                                            <img src="/static/img/crown.png" width="15" height="15" />
                                            {% endif %}
                                            <br />
                                            {% if matchup.total2 %}
                                            <span style="color: #000000">{{'%0.2f'| format(matchup.total2) }}</span>
                                            <span style="color: #888888">{{'%0.2f'| format(matchup.base2) }}</span>
                                            {% else %}
                                            <br />
                                            {% endif %}
                                            {% endif %}
                                            {% endfor %}
                                        </div>
                                    </div>
                                </button>

                            </h2>
                            <div id="{{'collapse' + round.number|string + '_' + matchup.id|string}}"
                                class="accordion-collapse collapse {% if (matchup.team1 in user.teams|selectattr('id', 'equalto', matchup.team1)|map(attribute = 'id')|list) or (matchup.team2 in user.teams|selectattr('id', 'equalto', matchup.team2)|map(attribute = 'id')|list) %}show{% endif %}"
                                aria-labelledby="{{'heading' + round.number|string + '_' + matchup.id|string}}"
                                data-bs-parent="{{'#round' + round.number|string }}">
                                <div class="accordion-body" align="center">

                                    <a class="btn btn-primary" id="Matchup View"
                                        href="/matchup?leagueid={{fantasy.id}}&m={{matchup.id}}">click here to go to the
                                        old page to do picks and bans</a>

                                    <ul class="list-group">
                                        {% set roles_list = ['top', 'jungle', 'mid', 'bottom', 'support'] %}
                                        {% for this_role in roles_list %}
                                        <li class="list-group-item">
                                            <div class="row">
                                                <div class="col">
                                                    {% for mteam in fantasy.teams %}
                                                    {% if mteam.id == matchup.team1 %}

                                                    {% for role in mteam.roles|selectattr("role", "equalto", this_role) %}
                                                    {% for player in role.players|selectattr("default", "equalto", true) %}
                                                    {% for team in tournament.teams|selectattr("id", "equalto", player.team) %}
                                                    <div class="row">
                                                        <div class="col" align="left">
                                                            {{team.code}}
                                                            <br />
                                                            {{ player.name }}
                                                            <br />
                                                            <div class="containerdiv" style="float:left;">
                                                                <img style="margin:0px"
                                                                    src="/static/img/league/icons/{{ role.role }}_icon.webp"
                                                                    width="100" height="100" />
                                                                <img class="cornerimage"
                                                                    src="/static/img/league/players/{{team.code}}/{{ player.name }}.png"
                                                                    width="100" height="100" />
                                                            </div>
                                                            {% if round.number == now + 1 %}
                                                            {% for game in role.games|selectattr("round", "<", round.number)|sort(reverse = true, attribute="round") %}
                                                            {% if game.champion %}
                                                            <img src="/static/img/league/champs/{{champions[game.champion - 1].name}}.png"
                                                                width="50" height="50"
                                                                style="border: 4px solid #000000;" />
                                                            {{'%0.2f'| format(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15)}}
                                                            {% endif %}
                                                            {% endfor %}
                                                            {% endif %}
                                                        </div>
                                                        <div class="col">
                                                            <div class="row">
                                                                {% if now >= round.number %}
                                                                <div class="col" align="center">
                                                                    {% if matchup['pick1'+role.role] %}
                                                                    {% for champ in matchup['pick1' + role.role] %}
                                                                    <img src="/static/img/league/champs/{{ champ.name }}.png"
                                                                        width="50" height="50"
                                                                        style="border: 4px solid #34A853;" />
                                                                    {%endfor%}
                                                                    {%endif%}

                                                                </div>
                                                                <div class="col" align="center">

                                                                    {% if matchup['ban1'+role.role] %}
                                                                    {% for champ in matchup['ban1' + role.role] %}
                                                                    <img src="/static/img/league/champs/{{ champ.name }}.png"
                                                                        width="50" height="50"
                                                                        style="border: 4px solid #EA4335;" />
                                                                    {%endfor%}
                                                                    {%endif%}
                                                                </div>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        <div class="col" align="left">
                                                            <ul class="list-group list-group-flush">
                                                                {% for game in role.games|selectattr("round", "equalto", round.number) %}
                                                                <li class="list-group-item" style="padding:0px;">
                                                                    <div class="row">

                                                                        {% if game.champion %}
                                                                        <div class="col px-0 mx-0">
                                                                            <input type="image"
                                                                                src="/static/img/league/champs/{{ champions[game.champion-1].name }}.png"
                                                                                width="50" height="50"
                                                                                data-bs-toggle="popover"
                                                                                data-bs-trigger="hover focus"
                                                                                title="{{game.gameId}}" data-bs-content='<div class="row"><div class="col-md-4"><img class="mr-3" title="
                                                                        {{champions[game.champion-1].name}}"
                                                                        src="/static/img/league/champs/{{ champions[game.champion-1].name }}.png"
                                                                        width="50" height="50" /></div><div class="col-md-8">{{game.kills}}/{{game.deaths}}/{{game.assists}} {{game.cs}} <br/> {% if game.dragons %}
                                                                            {% for i in range(game.dragons|length) %}
                                                                            {% if game.dragons[i] != 'e' %}
                                                                            {% if game.firstDragon and i == 0 %}
                                                                            <img class="dragon" style="margin: -5px"
                                                                              src="/static/img/league/icons/{{game.dragons[i]}}-dragon2-first.png" width="20"
                                                                              height="20" />
                                                                            {% else %}
                                      
                                                                            <img class="dragon" style="margin: -5px"
                                                                              src="/static/img/league/icons/{{game.dragons[i]}}-dragon2.png" width="20"
                                                                              height="20" />
                                      
                                                                            {% endif %}
                                                                            {% endif %}
                                                                            {% endfor %}
                                                                            {% endif %}
                                                                            {% if game.elders %}
                                                                            {% for i in range(game.elders) %}
                                                                            <img style="margin: -5px" src="/static/img/league/icons/elder-dragon2.png"
                                                                                width="20" height="20" />
                                                                            {% endfor %}
                                                                            {% endif %}
                                                                            {% if game.barons %}
                                                                            {% for j in range(game.barons) %}
                                                                            {% if game.firstBaron and j == 0 %}
                                                                            <img style="margin: -5px" src="/static/img/league/icons/nashor-icon-first.png"
                                                                                width="20" height="20" />
                                                                            {% else %}
                                                                            <img style="margin: -5px" src="/static/img/league/icons/nashor-icon.png"
                                                                                width="20" height="20" />
                                                                            {% endif %}
                                                                            {% endfor %}
                                                                            {% endif %}
                                                                        </div></div>' data-bs-placement="left"
                                                                                data-bs-custom-class="popover" style="margin: 0px 0px -6px 0px;
                                                                                {% if champions[game.champion-1] in matchup['pick1' + role.role] %}
                                                                        {% if champions[game.champion-1] in matchup['ban1' + role.role] %}
                                                                        border: solid #fbbc04
                                                                        {% else %}
                                                                        border: solid #34A853
                                                                        {% endif %}
                                                                        {% else %}
                                                                        {% if champions[game.champion-1] in matchup['ban1' + role.role] %}
                                                                        border: solid #EA4335
                                                                        {% else %}
                                                                        border: solid #000000
                                                                        {% endif %}
                                                                        {% endif %}
                                                                                " />
                                                                        </div>
                                                                        <div class="col-md-6 px-0 mx-0 text-nowrap">
                                                                            {% if champions[game.champion-1] in matchup['pick1' + role.role] %}
                                                                            {% if champions[game.champion-1] in matchup['ban1' + role.role] %}
                                                                            <span style="color: #000000">
                                                                                {{'%0.2f'| format(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15)}}
                                                                            </span>
                                                                            {% else %}
                                                                            <span
                                                                                style="color: #000000; background-color: #EEFFEE">
                                                                                {{'%0.2f'| format(fantasy.pickmul*(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15))}}
                                                                            </span>
                                                                            {% endif %}
                                                                            {% else %}
                                                                            {% if champions[game.champion-1] in matchup['ban1' + role.role] %}
                                                                            <span
                                                                                style="color: #000000; background-color: #FFEEEE">
                                                                                {{'%0.2f'| format(fantasy.banmul*(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15))}}
                                                                            </span>
                                                                            {% else %}
                                                                            <span style="color: #000000">
                                                                                {{'%0.2f'| format(1*(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15))}}
                                                                            </span>
                                                                            {% endif %}
                                                                            {% endif %}

                                                                            <br />
                                                                            <span style="color: #888888">
                                                                                {{'%0.2f'| format(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15)}}
                                                                            </span>
                                                                        </div>
                                                                        {% else %}
                                                                        <div class="col px-0 mx-0" align="left">
                                                                            <img title="None"
                                                                                src="/static/img/league/champs/empty.png"
                                                                                width="50" height="50" />
                                                                        </div>

                                                                        {% endif %}
                                                                    </div>

                                                                </li>
                                                                {% endfor %}
                                                            </ul>
                                                        </div>
                                                        <div class="col border" align="center">
                                                            <span
                                                                style="color: #000000">{{'%0.2f'| format(matchup['total1' + role.role]) }}</span>
                                                            <br />
                                                            <span
                                                                style="color: #888888">{{'%0.2f'| format(matchup['base1' + role.role]) }}</span>
                                                        </div>
                                                    </div>
                                                    {% endfor %}




                                                    {% endfor %}
                                                    {% endfor %}
                                                    {% endif %}
                                                    {% endfor %}
                                                </div>
                                                <div class="col">
                                                    {% for mteam in fantasy.teams %}
                                                    {% if mteam.id == matchup.team2 %}

                                                    {% for role in mteam.roles|selectattr("role", "equalto", this_role) %}
                                                    {% for player in role.players|selectattr("default", "equalto", true) %}
                                                    {% for team in tournament.teams|selectattr("id", "equalto", player.team) %}
                                                    <div class="row flex-row-reverse">
                                                        <div class="col" align="right">
                                                            {{team.code}}

                                                            <br />
                                                            {{ player.name }}
                                                            <br />
                                                            <div class="containerdiv" style="float:right">
                                                                <img style="margin:0px"
                                                                    src="/static/img/league/icons/{{ role.role }}_icon.webp"
                                                                    width="100" height="100" />
                                                                <img class="cornerimage"
                                                                    src="/static/img/league/players/{{team.code}}/{{ player.name }}.png"
                                                                    width="100" height="100" />
                                                            </div>
                                                            {% if round.number == now + 1 %}
                                                            {% for game in role.games|selectattr("round", "<", round.number)|sort(reverse = true, attribute="round") %}
                                                            {% if game.champion %}
                                                            {{'%0.2f'| format(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15)}}
                                                            <img src="/static/img/league/champs/{{champions[game.champion - 1].name}}.png"
                                                                width="50" height="50"
                                                                style="border: 4px solid #000000;" />
                                                            {% endif %}
                                                            {% endfor %}
                                                            {% endif %}
                                                        </div>
                                                        <div class="col" align="center">
                                                            <div class="row align-items-center">
                                                                {% if now >= round.number %}
                                                                <div class="col" align="center">
                                                                    {% if matchup['pick2'+role.role] %}
                                                                    {% for champ in matchup['pick2' + role.role] %}
                                                                    <img src="/static/img/league/champs/{{ champ.name }}.png"
                                                                        width="50" height="50"
                                                                        style="border: 4px solid #34A853;" />
                                                                    {%endfor%}
                                                                    {%endif%}

                                                                </div>
                                                                <div class="col" align="center">

                                                                    {% if matchup['ban2'+role.role] %}
                                                                    {% for champ in matchup['ban2' + role.role] %}
                                                                    <img src="/static/img/league/champs/{{ champ.name }}.png"
                                                                        width="50" height="50"
                                                                        style="border: 4px solid #EA4335;" />
                                                                    {%endfor%}
                                                                    {%endif%}
                                                                </div>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        <div class="col" align="right">
                                                            <ul class="list-group list-group-flush">
                                                                {% for game in role.games|selectattr("round", "equalto", round.number) %}
                                                                <li class="list-group-item" style="padding: 0px">
                                                                    <div class="row flex-row-reverse">
                                                                        {% if game.champion %}

                                                                        <div class="col px-0 mx-0">

                                                                            <input type="image"
                                                                                src="/static/img/league/champs/{{ champions[game.champion-1].name }}.png"
                                                                                width="50" height="50"
                                                                                data-bs-toggle="popover"
                                                                                data-bs-trigger="hover focus"
                                                                                title="{{game.gameId}}" data-bs-content='<div class="row"><div class="col-md-4"><img class="mr-3" title="
                                                                        {{champions[game.champion-1].name}}"
                                                                        src="/static/img/league/champs/{{ champions[game.champion-1].name }}.png"
                                                                        width="50" height="50" /></div><div class="col-md-8">{{game.kills}}/{{game.deaths}}/{{game.assists}} {{game.cs}} <br/> {% if game.dragons %}
                                                                            {% for i in range(game.dragons|length) %}
                                                                            {% if game.dragons[i] != 'e' %}
                                                                            {% if game.firstDragon and i == 0 %}
                                                                            <img class="dragon" style="margin: -5px"
                                                                              src="/static/img/league/icons/{{game.dragons[i]}}-dragon2-first.png" width="20"
                                                                              height="20" />
                                                                            {% else %}
                                      
                                                                            <img class="dragon" style="margin: -5px"
                                                                              src="/static/img/league/icons/{{game.dragons[i]}}-dragon2.png" width="20"
                                                                              height="20" />
                                      
                                                                            {% endif %}
                                                                            {% endif %}
                                                                            {% endfor %}
                                                                            {% endif %}
                                                                            
                                                                            {% if game.elders %}
                                                                            {% for i in range(game.elders) %}
                                                                            <img style="margin: -5px" src="/static/img/league/icons/elder-dragon2.png"
                                                                                width="20" height="20" />
                                                                                
                                                                            {% endfor %}
                                                                            {% endif %}
                                                                            {% if game.barons %}
                                                                            {% for j in range(game.barons) %}
                                                                            {% if game.firstBaron and j == 0 %}
                                                                            <img style="margin: -5px" src="/static/img/league/icons/nashor-icon-first.png"
                                                                                width="20" height="20" />
                                                                            {% else %}
                                                                            <img style="margin: -5px" src="/static/img/league/icons/nashor-icon.png"
                                                                                width="20" height="20" />
                                                                            {% endif %}
                                                                            {% endfor %}
                                                                            {% endif %}
                                                                        </div></div>' data-bs-placement="right"
                                                                                data-bs-custom-class="popover" style="margin: 0px 0px -6px 0px;
                                                                        {% if champions[game.champion-1] in matchup['pick2' + role.role] %}
                                                                        {% if champions[game.champion-1] in matchup['ban2' + role.role] %}
                                                                        border: solid #fbbc04
                                                                        {% else %}
                                                                        border: solid #34A853
                                                                        {% endif %}
                                                                        {% else %}
                                                                        {% if champions[game.champion-1] in matchup['ban2' + role.role] %}
                                                                        border: solid #EA4335
                                                                        {% else %}
                                                                        border: solid #000000
                                                                        {% endif %}
                                                                        {% endif %}
                                                                        " />
                                                                        </div>
                                                                        <div class="col-md-6 px-0 mx-0 text-nowrap">
                                                                            {% if champions[game.champion-1] in matchup['pick2' + role.role] %}
                                                                            {% if champions[game.champion-1] in matchup['ban2' + role.role] %}
                                                                            <span style="color: #000000">
                                                                                {{'%0.2f'| format(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15)}}
                                                                            </span>
                                                                            {% else %}
                                                                            <span
                                                                                style="color: #000000; background-color: #EEFFEE">
                                                                                {{'%0.2f'| format(fantasy.pickmul*(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15))}}
                                                                            </span>
                                                                            {% endif %}
                                                                            {% else %}
                                                                            {% if champions[game.champion-1] in matchup['ban2' + role.role] %}
                                                                            <span
                                                                                style="color: #000000; background-color: #FFEEEE">
                                                                                {{'%0.2f'| format(fantasy.banmul*(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15))}}
                                                                            </span>
                                                                            {% else %}
                                                                            <span style="color: #000000">
                                                                                {{'%0.2f'| format(1*(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15))}}
                                                                            </span>
                                                                            {% endif %}
                                                                            {% endif %}

                                                                            <br />
                                                                            <span style="color: #888888">
                                                                                {{'%0.2f'| format(game.kills * fantasy.kill + game.deaths * fantasy.death + game.assists * fantasy.assist + game.cs * fantasy.cs + game.wardsKilled * fantasy.wardKill + game.wardsPlaced * fantasy.wardPlace + game.firstBlood * fantasy.firstBlood + game.firstBaron * fantasy.firstBaron + game.firstDragon * fantasy.firstDragon + game.firstTower * fantasy.firstTower + game.barons * fantasy.baron + game.towers * fantasy.tower + game.soloKills + fantasy.soloKill + game.elders * fantasy.elder + game.dragons|length * fantasy.dragon + game.cs15 * fantasy.morecs15)}}
                                                                            </span>
                                                                        </div>
                                                                        {% else %}
                                                                        <div class="col px-0 mx-0" align="right">
                                                                            <img title="None"
                                                                                src="/static/img/league/champs/empty.png"
                                                                                width="50" height="50" />
                                                                        </div>
                                                                        {% endif %}
                                                                    </div>
                                                                </li>
                                                                {% endfor %}
                                                            </ul>
                                                        </div>
                                                        <div class="col border" align="center">
                                                            <span
                                                                style="color: #000000">{{'%0.2f'| format(matchup['total2' + role.role]) }}</span>
                                                            <br />
                                                            <span
                                                                style="color: #888888">{{'%0.2f'| format(matchup['base2' + role.role]) }}</span>
                                                        </div>
                                                    </div>
                                                    {% endfor %}



                                                    {% endfor %}
                                                    {% endfor %}
                                                    {% endif %}
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <button class="carousel-control-prev d-md-block" type="button" data-bs-target="#carouselExampleIndicators"
        data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next d-md-block" type="button" data-bs-target="#carouselExampleIndicators"
        data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
    </button>
</div>


{% endif %}



<!-- If we have no teams, that means we haven' t drafted yet. If we haven't drafted yet, we need to display draft
                                                                options. If we do have teams, we want to display them
                                                                all here, starting with [username], [team name?], then
                                                                displaying players + teams in order of their roles.-->
<form method="POST">
    <h2 align="center"> Players in Tournament </h1>

        <div style="text-align: center; padding-top: 10px;">
            <table style="border-collapse: collapse; width: 100%;" border="1">
                <tbody>
                    <tr>
                        <td style="width: 50%;">

                            <head>
                                <table style="border-collapse: collapse; width: 100%; background-color: #CCCCCC"
                                    border="1">
                                    <tbody>
                                        <tr>
                                            <td style="width: 16.6667%;">
                                                Team
                                            </td>
                                            <td style="width: 16.6667%;">
                                                Top</td>
                                            <td style="width: 16.6667%;">
                                                Jng</td>
                                            <td style="width: 16.6667%;">
                                                Mid</td>
                                            <td style="width: 16.6667%;">
                                                Bot</td>
                                            <td style="width: 16.6667%;">
                                                Sup</td>
                                        </tr>
                                        {% for team in tournament.teams %}
                                        <tr>
                                            <td style="width: 16.6667%;">
                                                {{ team.code }}
                                                <br />
                                                <img src="/static/img/league/teams/{{team.code}}.png" width="40"
                                                    height="40" />
                                            </td>

                                            {% for role in team.roles|selectattr("role", "equalto", 'top') %}
                                            {% if role in fantasy.roles %}
                                            <td style="width: 16.6667%; background-color: #555555">
                                                {% else %}
                                            <td style="width: 16.6667%;">
                                                <input type="radio" id="top" name="top" value="{{ role.id }}">
                                                {% endif %}
                                                <br />
                                                {% for player in role.players|selectattr("default", "equalto", true) %}
                                                {{ player.name }}
                                                <br />
                                                <img src="/static/img/league/players/{{ team.code }}/{{ player.name }}.png"
                                                    width="40" height="40" />
                                                <br />
                                                {% endfor %}
                                            </td>

                                            {% endfor %}
                                            {% for role in team.roles|selectattr("role", "equalto", 'jungle') %}
                                            {% if role in fantasy.roles %}
                                            <td style="width: 16.6667%; background-color: #555555">
                                                {% else %}
                                            <td style="width: 16.6667%;">
                                                <input type="radio" id="jungle" name="jungle" value="{{ role.id }}">
                                                {% endif %}
                                                <br />
                                                {% for player in role.players|selectattr("default", "equalto", true) %}
                                                {{ player.name }}
                                                <br />
                                                <img src="/static/img/league/players/{{ team.code }}/{{ player.name }}.png"
                                                    width="40" height="40" />
                                                <br />
                                                {% endfor %}
                                            </td>

                                            {% endfor %}
                                            {% for role in team.roles|selectattr("role", "equalto", 'mid') %}
                                            {% if role in fantasy.roles %}
                                            <td style="width: 16.6667%; background-color: #555555">
                                                {% else %}
                                            <td style="width: 16.6667%;">
                                                <input type="radio" id="mid" name="mid" value="{{ role.id }}">
                                                {% endif %}
                                                <br />
                                                {% for player in role.players|selectattr("default", "equalto", true) %}
                                                {{ player.name }}
                                                <br />
                                                <img src="/static/img/league/players/{{ team.code }}/{{ player.name }}.png"
                                                    width="40" height="40" />
                                                <br />
                                                {% endfor %}
                                            </td>

                                            {% endfor %}
                                            {% for role in team.roles|selectattr("role", "equalto", 'bottom') %}
                                            {% if role in fantasy.roles %}
                                            <td style="width: 16.6667%; background-color: #555555">
                                                {% else %}
                                            <td style="width: 16.6667%;">
                                                <input type="radio" id="bottom" name="bottom" value="{{ role.id }}">
                                                {% endif %}
                                                <br />
                                                {% for player in role.players|selectattr("default", "equalto", true) %}
                                                {{ player.name }}
                                                <br />
                                                <img src="/static/img/league/players/{{ team.code }}/{{ player.name }}.png"
                                                    width="40" height="40" />
                                                <br />
                                                {% endfor %}
                                            </td>

                                            {% endfor %}
                                            {% for role in team.roles|selectattr("role", "equalto", 'support') %}
                                            {% if role in fantasy.roles %}
                                            <td style="width: 16.6667%; background-color: #555555">
                                                {% else %}
                                            <td style="width: 16.6667%;">
                                                <input type="radio" id="support" name="support" value="{{ role.id }}">
                                                {% endif %}
                                                <br />
                                                {% for player in role.players|selectattr("default", "equalto", true) %}
                                                {{ player.name }}
                                                <br />
                                                <img src="/static/img/league/players/{{ team.code }}/{{ player.name }}.png"
                                                    width="40" height="40" />
                                                <br />
                                                {% endfor %}
                                            </td>

                                            {% endfor %}

                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </head>
                        </td>
                        <td>
                            {% for team in fantasy.teams %}
                            {% if team.owner == user.id %}
                            <table style="border-collapse: collapse; width: 100%; background-color: #dcdccc" border="1">
                                {% else %}
                                <table style="border-collapse: collapse; width: 100%; background-color: #cccccc"
                                    border="1">
                                    {% endif %}
                                    <tbody>
                                        <tr>

                                            {% set roles_list = ['top', 'jungle', 'mid', 'bottom', 'support'] %}
                                            {% for this_role in roles_list %}
                                            {% for role in team.roles|selectattr("role", "equalto", this_role) %}
                                            {% for player in role.players|selectattr("default", "equalto", true) %}
                                            {% for team in tournament.teams|selectattr("id", "equalto", player.team) %}

                                            <td style="width: 15%; text-align: center">
                                                {{team.code}}
                                                <br />
                                                {{player.name}}
                                                <br /><img src="/static/img/league/icons/{{role.role}}_icon.webp"
                                                    width="20" height="20" />
                                                <br />
                                                <img src="/static/img/league/players/{{team.code}}/{{ player.name }}.png"
                                                    width="40" height="40" />
                                                <br />
                                            </td>
                                            {% endfor %}
                                            {% endfor %}
                                            {% endfor %}
                                            {% endfor %}
                                            <td style="width: 20%; text-align: center">
                                                {{ team.name }}
                                                {% if team.owner == user.id or fantasy.owner == user.id %}
                                                {% if team.roles|length != 5 %}
                                                <br />
                                                <button type="submit" name="action" class="btn btn-primary"
                                                    value="team{{team.id}}">Add
                                                    Players</button>
                                            </td>
                                            {% endif %}
                                            {% endif %}
                                        </tr>
                                    </tbody>
                                </table>
                                {% endfor %}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
</form>

<br />
<br />
{% endblock %}

{% block scripts %}
<script>
    $(document).ready(function () {
        $('[data-bs-toggle="popover"]').popover({ html: true });
    });
</script>
{% endblock %}